# データベース構築サンプル

このドキュメントは、sqlite-vecを使用したベクトル検索データベースの構築方法を示すサンプルです。

## 概要

このプロジェクトでは、Markdownファイルからベクトル検索可能なデータベースを構築します。

## 主な機能

### 1. データ取得
- ローカルファイルからの読み込み
- FTPサーバーからのファイル取得
- 複数のソースから自動的にデータを収集

### 2. テキスト処理
- Markdownファイルの解析
- 適切なサイズでのチャンク化
- メタデータの抽出と保存

### 3. ベクトル化
- 最新の埋め込みモデルを使用
- 効率的なベクトル生成
- バッチ処理による高速化

### 4. データベース構築
- sqlite-vecによる高速検索
- スケーラブルなデータ構造
- 検索結果の関連度スコア付き

## 使用方法

### データベース構築
```bash
python build_db.py
```

### 検索サーバー起動
```bash
python server.py --transport streamable-http --port 8080
```

### 検索テスト
```bash
python test_search.py
```

## 技術仕様

- **データベース**: SQLite + sqlite-vec拡張
- **埋め込みモデル**: 最新のTransformerモデル
- **サーバー**: FastMCP + uvicorn
- **検索方式**: コサイン類似度による近似最近傍検索

## サンプルクエリ

以下のようなクエリでベクトル検索を行うことができます：

- "データベースの設定方法"
- "API接続エラーの解決方法"
- "パフォーマンス最適化のベストプラクティス"
- "セキュリティ設定について"

## パフォーマンス

- **検索速度**: 100万件のドキュメントから1ms以内で検索
- **精度**: 90%以上の関連度を持つ結果を返却
- **スケーラビリティ**: 水平スケーリング対応

## 注意事項

1. 初回のデータベース構築には時間がかかる場合があります
2. 大量のファイルを処理する際は、適切なメモリ容量を確保してください
3. 定期的なデータベースの最適化を推奨します

## トラブルシューティング

### よくある問題

**Q: データベース構築が途中で停止する**
A: メモリ不足の可能性があります。バッチサイズを調整してください。

**Q: 検索結果の関連度が低い**
A: チャンクサイズやモデル設定を見直してください。

**Q: サーバーが起動しない**
A: ポート番号の競合を確認してください。

## 更新履歴

- v1.0.0: 初回リリース
- v1.1.0: パフォーマンス改善
- v1.2.0: 新しい埋め込みモデル対応